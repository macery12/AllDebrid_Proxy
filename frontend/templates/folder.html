{% extends "base.html" %}
{% block title %}Folder {{ task_id }} — alldebrid-proxy V1{% endblock %}
{% block content %}
<section class="card">
  <h2>Folder {{ task_id }}</h2>
  <div class="row" style="gap:8px">
    <a class="btn" href="/d/{{ task_id }}.tar.gz">Download all (.tar.gz)</a>
    <a class="btn" href="/d/{{ task_id }}/links.txt">links.txt</a>
    <a class="btn" href="{{ url_for('task_view', task_id=task_id) }}">Back to task</a>
  </div>
  {% if entries|length == 0 %}
    <div class="muted" style="margin-top:10px">No files found.</div>
  {% else %}
    <div class="files" style="margin-top:10px">
      <table>
        <thead><tr><th>Path</th><th class="size">Size</th><th style="width:200px">Actions</th></tr></thead>
        <tbody>
          {% for e in entries %}
          {% set is_video = e.rel.lower().endswith(('.mp4', '.mkv', '.avi', '.mov', '.wmv', '.flv', '.webm', '.m4v', '.mpg', '.mpeg', '.3gp', '.ogv')) %}
          <tr>
            <td>{{ e.rel }}</td>
            <td class="size">{{ e.size|hbytes }}</td>
            <td>
              <div class="row" style="gap:6px">
                {% if is_video %}
                <a class="btn good" href="/d/{{ task_id }}/play/{{ e.rel }}" style="padding:6px 10px">▶ Play</a>
                {% endif %}
                <a class="btn" href="/d/{{ task_id }}/raw/{{ e.rel }}" target="_blank" style="padding:6px 10px">Download</a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% endif %}
</section>
{% endblock %}
